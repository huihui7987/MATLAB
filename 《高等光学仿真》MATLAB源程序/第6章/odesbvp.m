function odesbvp
%`常微分方程组边值问题的数值求解`

solinit = bvpinit(linspace(0,1,5),@odesguess);
options = bvpset('Stats','on','RelTol',1e-5);
sol = bvp4c(@odes,@odesbc,solinit,options);

%`网格点处的数值解`
x = sol.x;
y = sol.y;

% `采用 MUSN 方法求解到的数值解:`
amrx = [ 0. .1 .2 .3 .4 .5 .6 .7 .8 .9 1.]';
amry = [1.00000e+00  1.00000e+00  1.00000e+00  -1.00000e+01  9.67963e-01
        1.00701e+00  9.93036e-01  1.27014e+00  -9.99304e+00  1.24622e+00
        1.02560e+00  9.75042e-01  1.47051e+00  -9.97504e+00  1.45280e+00
        1.05313e+00  9.49550e-01  1.61931e+00  -9.94955e+00  1.60610e+00
        1.08796e+00  9.19155e-01  1.73140e+00  -9.91915e+00  1.72137e+00
        1.12900e+00  8.85737e-01  1.81775e+00  -9.88574e+00  1.80994e+00
        1.17554e+00  8.50676e-01  1.88576e+00  -9.85068e+00  1.87957e+00
        1.22696e+00  8.15025e-01  1.93990e+00  -9.81503e+00  1.93498e+00
        1.28262e+00  7.79653e-01  1.98190e+00  -9.77965e+00  1.97819e+00
        1.34161e+00  7.45374e-01  2.01050e+00  -9.74537e+00  2.00827e+00
        1.40232e+00  7.13102e-01  2.02032e+00  -9.71310e+00  2.02032e+00];

% `将第4列的值向上平移10以便做图对比`
amry(:,4) = amry(:,4) + 10;
y(4,:) = y(4,:) + 10;

figure
plot(x,y',amrx,amry,'*')
axis([0 1 -0.5 2.5])
title('常微分方程组边值问题的数值解')
ylabel('bvp4c 和 MUSN(*) 方法的数值解')
xlabel('x')

%-------------------------------------------------------------------------
function dydx = odes(x,y)
% `边值问题的常微分方程组，dydx中各元素分别对应于`
% dydx(1) = u, dydx (2) = v, dydx (3) = w, dydx (4) = z, dydx (5) = y.
dydx =  [ 0.5*y(1)*(y(3) - y(1))/y(2)
         -0.5*(y(3) - y(1))
         (0.9 - 1000*(y(3) - y(5)) - 0.5*y(3)*(y(3) - y(1)))/y(4)
          0.5*(y(3) - y(1))
          100*(y(3) - y(5)) ];

%-------------------------------------------------------------------------
function res = odesbc(ya,yb)
% `常微分方程组的边值条件`
res = [ ya(1) - 1
        ya(2) - 1
        ya(3) - 1
        ya(4) + 10
        yb(3) - yb(5)];

%-------------------------------------------------------------------------
 function v = odesguess(x)
% `初始的猜想函数`
v = [        1
             1
     -4.5*x^2+8.91*x+1
            -10
     -4.5*x^2+9*x+0.91 ];